使用wmctrl控制窗口行为使用wmctrl控制窗口行为
2008年04月08日 星期二 , 1,260 次点击

前两天我谈了窗口匹配工具Devil’s Pie的使用，和DP一样，wmctrl同样可以控制窗口的行为。不同的是，DP是一个规则匹配工具，通过检查既有的窗口规则配置文件在DP启动时或窗口打开时应用规则到窗口；而wmctrl是一个命令行工具，它完全通过命令行命令来控制窗口行为。

一个使用wmctrl操纵窗口行为的实际命令如下：

    wmctrl -r firefox -b add,shaded

此命令将标题中含有”firefox”字串的窗口折叠起来。

wmctrl的命令行命令格式分为三个组成部分：动作、选项和参数。

要控制一个窗口的行为，首先要让wmctrl找到这个窗口。在这一点上，wmctrl是通过参数来实现的。

<DESK>

值为一个整数，用来指定相应的工作区。和DP不同，wmctrl从0开始计数，即第一个虚拟桌面为0，第二个是1。

<MVARG>

一个”g,x,y,w,h”格式的字符串，用来指定窗口的层次、位置和大小。其中，”g”代表窗口的层次，所有窗口普通层次的值都为0；”x”和 ”y”分别是窗口的横、竖坐标；”w”和”h”分别是窗口的宽度和高度。五个参数都是整数，宽度和高度的值如果不需要改变，可以使用”-1″来代替。

<WIN>

缺省情况下，此参数表示一个字符串，所有标题中含有此字符串的窗口都是匹配项，忽略大小写。如果加上”-F”选项，则会检查大小写。如果使用”-i”的选项，此参数将被当作一个整数来进行比较。

此参数有两个特殊值：”:SELECT:”表示命令执行后需要用户选择一个窗口作为目标，然后将命令作用到该窗口；”:ACTIVE:”表示将当前处于活动状态的窗口作为命令执行目标。

<WORKAROUND>

当前只实现了一个workaround属性，即”DESKTOP_TITLES_INVALID_UTF8″。在使用Window Maker作为窗口管理器时可以修正打印非ASCII编码窗口标题的输出结果。

wmctrl选择目标窗口的选项并不如DP丰富和精确，不过大多数情况下并不影响使用，况且通过”<WIN>“参数的两个特殊值可以多少弥补一些选项上的缺失，且能提供一种更机动的操作方式。

当选择了目标窗口后，就要向该窗口指定具体行为了。这一点通过”动作”来实现。

-a <WIN>

移动到该窗口所在的工作区，提升该窗口的层次，并将输入焦点置于该窗口上。

-b ( add | remove | toggle),prop1 [,prop2 ]

为选定窗口添加(add)、移除(remove)或切换(toggle)相应的一个或两个属性。这些属性包括：modal, sticky(粘贴), maximized_vert(竖向最大化), maximized_horz(横向最大化), shaded(折叠), skip_taskbar(不在任务栏中显示), skip_pager(不在pager中显示), hidden(隐藏), fullscreen(全屏), above(窗口置于最上层)和below(窗口置于最下层)。

-c <WIN>

试探性地关闭指定窗口。

-d

在终端中列出当前窗口管理器管理的所有虚拟桌面的详细信息。

-e <MVARG>

将窗口几何属性字符串应用到指定窗口。

-g w,h

改变窗口的宽度和高度。

-h

打印wmctrl的帮助信息到终端。

-I name

设定一个窗口的缩略名为”name”。

-k ” (” on ” | ” off ” )”

打开或关闭窗口管理器的”show the desktop”模式，如果该窗口管理器支持的话。

-l

在终端中列出当前所有窗口的属性。如果使用了”-p”的参数，属性中将包含窗口的PID值；如果使用了”-G”参数，属性中将包含窗口的几何属性(横竖坐标、宽度和高度)。

-m

显示窗口管理器的信息。

-n N

改变当前虚拟桌面的数量。

-N name

改变指定窗口的标题。

-o x,y

改变指定窗口的”viewport”值，窗口管理器可能会忽略这个命令。

-r <WIN>

选择标题中含有相应字符串的窗口。

-R <WIN>

选择标题中含有指定字符串的窗口，将它移动到当前工作区，提升其层次并将输入焦点置于其上。

-s <DESK>

移动到该工作区。

-t <DESK>

将通过”-r”选定的窗口移动到指定工作区。

-T name

同时修改选定窗口的的标题和缩略名。

通过参数和动作，wmctrl已经可以控制大多数窗口的行为了。同时，通过选项，wmctrl可以进一步细化这些行为。

-F

在通过”-r”进行窗口标题匹配时使用不忽略字母大小写的精确匹配。

-G

在通过”-l”动作输出窗口属性时，在输出结果中添加窗口几何属性。

-i

将窗口标题作为一个数字值进行比较。

-p

在通过”-l”动作输出窗口属性时，在输出结果中添加窗口PID属性。

-u

覆盖自动探测和强制UTF-8编码模式。

-v

打印详细的信息到终端，在调试wmctrl自身时很有用。

-w [ <WORKAROUND>[,<WORKAROUND>]… ]

在参数中使用指定的workaround属性值。

-x

在窗口列表中包含窗口class属性，或指定”<WIN>“为窗口的class值而非标题。

下面是一些wmctrl命令的例子：

    wmctrl -l

列出当前所有窗口的信息。

    wmctrl -p -G -l

列出包含窗口PID和几何属性信息的所有窗口信息。

    wmctrl -a emacs

移动到标题中含有”emacs”字符串的窗口。

    wmctrl -r mozilla -b add,shaded

将标题中含有”mozilla”的窗口折叠起来。

    wmctrl -F -c ‘Debian bug tracking system – Mozilla’

将一个标题与给定字符串大小写匹配的窗口关闭。

    wmctrl -i -r 0×0120002 -b add,sticky

将窗口标题按照数字值进行大小比较，然后将选定的窗口置为粘贴状态。

    wmctrl -r :SELECT: -T “Selected Window”

选择一个窗口，然后将它的标题修改为”Selected Window”。

直接在终端中输入命令来控制窗口行为显得很笨拙，不过，我们可以通过设置热键来代替常用命令的输入，这就简便多了。
